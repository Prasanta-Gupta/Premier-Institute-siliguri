<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Account Ban Checker</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body {
    margin: 0;
    font-family: "Segoe UI", Arial, sans-serif;
    background: #f5f7fa;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }

  .status-block {
    background: #fff;
    border: 1px solid #ccc;
    border-radius: 20px;
    padding: 25px 30px;
    max-width: 400px;
    width: 90%;
    text-align: center;
    box-shadow: 0 12px 25px rgba(0,0,0,0.15);
  }

  .status-message {
    font-size: 1.2rem;
    color: #003366;
    font-weight: bold;
  }

  .ban-screen {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    backdrop-filter: blur(6px);
    background: rgba(0,0,0,0.5);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 999;
  }

  .ban-box {
    background: #fff;
    border: 2px solid #ff4d4d;
    border-radius: 30px;
    padding: 30px;
    max-width: 450px;
    width: 90%;
    text-align: center;
    box-shadow: 0 20px 40px rgba(0,0,0,0.2);
  }

  .ban-box h2 {
    color: #d32f2f;
    margin-bottom: 15px;
    font-size: 1.8rem;
  }

  .ban-box ul {
    text-align: left;
    margin: 10px 0;
    padding-left: 20px;
    font-size: 0.95rem;
  }

  .btn {
    margin-top: 15px;
    padding: 12px;
    width: 100%;
    background: #1976d2;
    color: #fff;
    font-weight: bold;
    border: none;
    border-radius: 20px;
    cursor: pointer;
    font-size: 1rem;
  }

  .btn:hover { background: #115293; }

  .pass-input {
    margin-top: 12px;
    padding: 10px;
    width: 100%;
    border: 1px solid #1976d2;
    border-radius: 15px;
    font-size: 1rem;
  }
</style>
</head>
<body>

<div class="status-block">
  <div class="status-message" id="status-msg">Initializing...</div>
</div>

<div class="ban-screen" id="ban-screen">
  <div class="ban-box">
    <h2>HELLO <span id="ban-user"></span></h2>
    <p>YOU ARE BANNED</p>
    <p>Possible reasons:</p>
    <ul>
      <li>Fake Info / Number</li>
      <li>Server abuse</li>
      <li>Swearing in restricted areas</li>
    </ul>
    <p>Contact Admin: +919679145745</p>
    <input type="password" id="unbanPass" class="pass-input" placeholder="Enter unban pass">
    <button class="btn" onclick="unban()">Unban</button>
  </div>
</div>

<script>
const JSON_BIN_ID = "68d5789ed0ea881f408ad215";
const MASTER_KEY = "$2a$10$5TyPwxtO8pS6G5qBROpTx.PX3NTZx3bg/W6cnelH2J5Qzyfz27ZA.";
const BAN_KEY = "BANNED_USER";

const currentUser = JSON.parse(localStorage.getItem("currentUser") || '{}');
const username = currentUser.Name || currentUser.name;

if(!username) {
  window.location.href = "page1.html"; // Redirect if no username
}

function showBan(name) {
  document.getElementById("ban-user").textContent = name;
  document.getElementById("ban-screen").style.display = "flex";
}

function unban() {
  const pass = document.getElementById("unbanPass").value;
  if(pass === "GUPTA") {
    localStorage.removeItem(BAN_KEY);
    alert("Unbanned. Reloading...");
    location.reload();
  } else {
    alert("Incorrect unban password!");
  }
}

async function checkUser() {
  document.getElementById("status-msg").textContent = `Checking account status of ${username}...`;

  const bannedTime = localStorage.getItem(BAN_KEY);
  if(bannedTime && (Date.now() - parseInt(bannedTime) < 24*60*60*1000)) {
    showBan(username);
    return;
  }

  try {
    const res = await fetch(`https://api.jsonbin.io/v3/b/${JSON_BIN_ID}/latest`, {
      headers: { "X-Master-Key": MASTER_KEY }
    });
    const data = await res.json();
    const users = data.record.users || [];
    const user = users.find(u => u.Name.toLowerCase() === username.toLowerCase());

    if(!user) {
      // Redirect to page1 if user not found
      window.location.href = "page1.html";
      return;
    }

    document.getElementById("status-msg").textContent = `Role found: ${user.Role}`;

    if(user.Role.toUpperCase() === "BAN") {
      localStorage.setItem(BAN_KEY, Date.now());
      showBan(user.Name);
    } else {
      window.location.href = "page1.html";
    }

  } catch(err) {
    console.error(err);
    window.location.href = "page1.html"; // Fail-safe redirect
  }
}

checkUser();
</script>
</body>
</html>
