<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reviews - Premier Institute</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
body {
  margin:0; font-family: Arial, sans-serif;
  background: linear-gradient(135deg,#dbeafe,#eff6ff);
  min-height:100vh;
  padding:20px;
  display:flex;
  flex-direction:column;
}
header { text-align:center; margin-bottom:20px; }
header h1 { margin:0; font-size:28px; }
header small { color:#2563eb; font-size:14px; }

/* Review Form */
.review-form {
  background:#fff;
  border-radius:8px;
  box-shadow:0 4px 12px rgba(0,0,0,0.1);
  padding:10px;
  margin-bottom:25px;
}
.review-form h2 { margin:0 0 15px; font-size:20px; color:#003366; }
.review-form input, .review-form textarea {
  width:100%; padding:10px; margin:8px 0;
  border:1px solid #ccc; border-radius:8px; font-size:14px;
}
.star-rating {
  display:flex; flex-direction:row-reverse; justify-content:flex-end;
  gap:5px; margin:10px 0;
}
.star-rating input { display:none; }
.star-rating label {
  font-size:22px; color:#ccc; cursor:pointer; transition:0.2s;
}
.star-rating input:checked ~ label,
.star-rating label:hover,
.star-rating label:hover ~ label { color:#f59e0b; }
.submit-btn {
  display:block; margin-top:10px;
  background:#2563eb; color:#fff; font-weight:bold;
  padding:10px 16px; border:none; border-radius:10px;
  cursor:pointer; font-size:15px; transition:0.3s;
}
.submit-btn:hover { background:#1d4ed8; }

/* Review Block */
.review-card {
  background:#fff;
  border-radius:15px;
  box-shadow:0 4px 12px rgba(0,0,0,0.1);
  padding:20px; margin-bottom:15px;
}
.review-card h3 { margin:0; font-size:16px; color:#000; }
.review-card small { color:#555; font-size:13px; }
.review-card .stars { color:#f59e0b; margin:5px 0; }
</style>
</head>
<body>

<header>
  <h1>Reviews</h1>
  <small>Premier Institute</small>
</header>

<!-- Review Form -->
<div class="review-form">
  <h2>Leave a Review</h2>
  <input type="text" id="username" placeholder="Name [Optional]">
  <textarea id="reviewText" rows="3" placeholder="Write your review..."></textarea>

  <!-- Stars -->
  <div class="star-rating">
    <input type="radio" id="star5" name="rating" value="5"><label for="star5">★</label>
    <input type="radio" id="star4" name="rating" value="4"><label for="star4">★</label>
    <input type="radio" id="star3" name="rating" value="3"><label for="star3">★</label>
    <input type="radio" id="star2" name="rating" value="2"><label for="star2">★</label>
    <input type="radio" id="star1" name="rating" value="1"><label for="star1">★</label>
  </div>

  <button class="submit-btn" onclick="submitReview()">Submit Review</button>
</div>

<!-- Reviews List -->
<div id="reviewsContainer"></div>

<script>
const JSON_BIN_ID = "68d66b20ae596e708ffc7bc5";
const MASTER_KEY = "$2a$10$5TyPwxtO8pS6G5qBROpTx.PX3NTZx3bg/W6cnelH2J5Qzyfz27ZA.";

async function loadReviews(){
  try{
    const res = await fetch(`https://api.jsonbin.io/v3/b/${JSON_BIN_ID}/latest`, {
      headers: {"X-Master-Key": MASTER_KEY}
    });
    const data = await res.json();
    const reviews = data.record.reviews || [];
    const container = document.getElementById("reviewsContainer");
    container.innerHTML="";
    reviews.forEach(r=>{
      const div=document.createElement("div");
      div.className="review-card";
      div.innerHTML=`
        <h3>${r.user}</h3>
        <div class="stars">${"★".repeat(Math.round(r.stars))}</div>
        <p>${r.review}</p>
      `;
      container.appendChild(div);
    });
  } catch(err){ console.error("Failed to load reviews:",err); }
}

async function submitReview(){
  const name=document.getElementById("username").value.trim()||"Anonymous";
  const review=document.getElementById("reviewText").value.trim();
  const stars=document.querySelector("input[name='rating']:checked");
  if(!review||!stars) return alert("Please enter review and select stars.");

  try{
    const res=await fetch(`https://api.jsonbin.io/v3/b/${JSON_BIN_ID}/latest`, {
      headers:{"X-Master-Key":MASTER_KEY}
    });
    const data=await res.json();
    const record=data.record;
    record.reviews.push({user:name,review:review,stars:parseFloat(stars.value)});
    record.reviewsCount=record.reviews.length;

    await fetch(`https://api.jsonbin.io/v3/b/${JSON_BIN_ID}`, {
      method:"PUT",
      headers:{
        "Content-Type":"application/json",
        "X-Master-Key":MASTER_KEY
      },
      body:JSON.stringify(record)
    });

    alert("Review submitted!");
    loadReviews();
  } catch(err){ console.error("Failed to submit review:",err); }
}

loadReviews();
</script>
</body>
</html>